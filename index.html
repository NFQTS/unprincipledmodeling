<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Creator Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    min-height: 100vh;
    font-family: 'Inter', system-ui, sans-serif;
    background: 
      radial-gradient(circle at 15% 15%, rgba(123,97,255,0.12), transparent 45%),
      radial-gradient(circle at 85% 25%, rgba(0,224,255,0.10), transparent 50%),
      #050007;
    color: #f8f9ff;
    overflow-x: hidden;
  }

  /* MAGIC PORTAL - Upload Animation */
  .magic-portal {
    position: fixed;
    inset: 0;
    background: #030005;
    z-index: 10000;
    display: grid;
    place-items: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.7s ease;
  }

  .magic-portal.visible {
    opacity: 1;
    pointer-events: all;
  }

  .portal-content {
    text-align: center;
    position: relative;
  }

  .portal-title {
    font-size: clamp(3.5rem, 10vw, 8rem);
    font-weight: 900;
    background: linear-gradient(90deg, #8b71ff, #00f0ff, #ff7bff, #8b71ff);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    background-size: 300% auto;
    animation: shine 5s linear infinite;
    letter-spacing: -0.04em;
    margin-bottom: 1.2rem;
  }

  @keyframes shine {
    to { background-position: 300% center; }
  }

  .portal-subtitle {
    font-size: 1.4rem;
    color: #b0b8ff;
    opacity: 0.8;
    max-width: 520px;
    margin: 0 auto 3.5rem;
  }

  .progress-text {
    font-size: 3.6rem;
    font-weight: 900;
    color: white;
    text-shadow: 0 0 40px rgba(123,97,255,0.7);
  }

  .portal-spinner {
    width: 300px;
    height: 300px;
    position: relative;
    margin: 0 auto 4rem;
  }

  .orb {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    background: linear-gradient(135deg, rgba(123,97,255,0.35), rgba(0,240,255,0.25));
    backdrop-filter: blur(24px);
    animation: float 7s ease-in-out infinite;
  }

  .orb:nth-child(2) { animation-delay: -2.3s; background: linear-gradient(135deg, rgba(255,123,255,0.3), rgba(0,240,255,0.3)); }
  .orb:nth-child(3) { animation-delay: -4.6s; background: linear-gradient(135deg, rgba(123,97,255,0.3), rgba(255,123,255,0.3)); }

  @keyframes float {
    0%,100% { transform: translate(0,0) scale(1); opacity: 0.45; }
    50%     { transform: translate(60px, -80px) scale(1.18); opacity: 0.95; }
  }

  /* MAIN LAYOUT */
  .upload-state, .dashboard-state {
    min-height: 100vh;
    padding: 4rem 2rem;
    display: none;
  }

  .upload-state {
    display: grid;
    place-items: center;
    text-align: center;
  }

  .upload-state h1 {
    font-size: clamp(3.5rem, 9vw, 7rem);
    font-weight: 900;
    background: linear-gradient(135deg, #ffffff, #d0d8ff, #8b71ff, #00f0ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 1.5rem;
    line-height: 0.95;
  }

  .upload-btn {
    display: inline-flex;
    align-items: center;
    gap: 1rem;
    background: linear-gradient(135deg, #8b71ff, #00f0ff);
    color: black;
    font-weight: 800;
    font-size: 1.35rem;
    padding: 1.5rem 3.5rem;
    border-radius: 999px;
    border: none;
    cursor: pointer;
    box-shadow: 0 0 50px rgba(123,97,255,0.45);
    transition: all 0.4s ease;
    position: relative;
    overflow: hidden;
  }

  .upload-btn:hover {
    transform: translateY(-6px) scale(1.04);
    box-shadow: 0 0 80px rgba(123,97,255,0.7);
  }

  .upload-btn::after {
    content: "";
    position: absolute;
    top: -50%; left: -50%;
    width: 200%; height: 200%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
    transform: translateX(-100%);
    transition: transform 0.7s ease;
  }

  .upload-btn:hover::after {
    transform: translateX(100%);
  }

  input[type="file"] { display: none; }

  /* DASHBOARD */
  .dashboard-state.active { display: block; }

  .container { max-width: 1440px; margin: 0 auto; }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 2rem;
    margin-bottom: 4rem;
  }

  .profile-section {
    display: flex;
    align-items: center;
    gap: 2.5rem;
  }

  .profile-image {
    width: 160px;
    height: 160px;
    border-radius: 28px;
    object-fit: cover;
    border: 4px solid rgba(123,97,255,0.4);
    box-shadow: 0 0 60px rgba(123,97,255,0.35);
  }

  .profile-info h1 {
    font-size: 3.2rem;
    font-weight: 900;
    background: linear-gradient(to right, #ffffff, #8b71ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .profile-info p {
    color: #a0a8ff;
    font-size: 1.25rem;
    margin-top: 0.5rem;
  }

  .add-more-btn {
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.14);
    color: white;
    padding: 1rem 2rem;
    border-radius: 20px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .add-more-btn:hover {
    background: rgba(255,255,255,0.14);
    transform: translateY(-3px);
  }

  /* STATS */
  .mega-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 2rem;
    margin-bottom: 5rem;
  }

  .mega-card {
    background: rgba(255,255,255,0.04);
    backdrop-filter: blur(20px);
    border-radius: 32px;
    padding: 2.8rem;
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow: 0 20px 60px rgba(0,0,0,0.45);
    transition: all 0.4s ease;
  }

  .mega-card:hover {
    transform: translateY(-12px);
    box-shadow: 0 30px 90px rgba(0,0,0,0.6);
  }

  .mega-label {
    color: #a0a8ff;
    font-size: 0.95rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    margin-bottom: 1.2rem;
  }

  .mega-value {
    font-size: 4.8rem;
    font-weight: 900;
    background: linear-gradient(90deg, #ffffff, #00f0ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
  }

  .mega-sub {
    color: #8088cc;
    margin-top: 0.8rem;
    font-size: 1.1rem;
  }

  /* GALLERY */
  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 2.5rem;
  }

  .asset-card {
    background: rgba(255,255,255,0.05);
    backdrop-filter: blur(16px);
    border-radius: 28px;
    overflow: hidden;
    border: 1px solid rgba(255,255,255,0.08);
    transition: all 0.4s ease;
  }

  .asset-card:hover {
    transform: translateY(-12px);
    box-shadow: 0 30px 80px rgba(0,0,0,0.55);
  }

  .asset-preview {
    height: 260px;
    background: linear-gradient(135deg, rgba(123,97,255,0.2), rgba(0,240,255,0.15));
  }

  .asset-preview img, .asset-preview video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .asset-content {
    padding: 1.8rem;
  }

  .asset-name {
    font-size: 1.45rem;
    font-weight: 700;
    margin-bottom: 1.5rem;
  }

  .asset-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.2rem;
  }

  .stat-item {
    background: rgba(255,255,255,0.04);
    border-radius: 16px;
    padding: 1.2rem;
    text-align: center;
    border: 1px solid rgba(255,255,255,0.06);
  }

  .stat-label {
    color: #a0a8ff;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 0.5rem;
  }

  .stat-value {
    font-size: 1.6rem;
    font-weight: 800;
  }

  .stat-value.earnings {
    background: linear-gradient(90deg, #00f0ff, #8b71ff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .delete-icon {
    position: absolute;
    top: 1.2rem;
    left: 1.2rem;
    width: 44px;
    height: 44px;
    background: rgba(255,60,60,0.3);
    backdrop-filter: blur(12px);
    border-radius: 14px;
    color: #ff7777;
    font-size: 1.8rem;
    font-weight: bold;
    display: grid;
    place-items: center;
    cursor: pointer;
    transition: all 0.3s;
    z-index: 10;
  }

  .delete-icon:hover {
    background: rgba(255,60,60,0.6);
    transform: scale(1.15);
  }

  @media (max-width: 900px) {
    .header { flex-direction: column; text-align: center; }
    .profile-section { flex-direction: column; }
    .mega-stats { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

  <!-- MAGIC PORTAL OVERLAY -->
  <div id="magicPortal" class="magic-portal">
    <div class="portal-content">
      <div class="portal-spinner">
        <div class="orb"></div>
        <div class="orb"></div>
        <div class="orb"></div>
      </div>
      <h1 class="portal-title">Building Your Empire...</h1>
      <p class="portal-subtitle">Analyzing aesthetic • Extracting vibe • Unlocking potential</p>
      <div class="progress-text" id="progressText">0%</div>
    </div>
  </div>

  <!-- UPLOAD STATE -->
  <div class="upload-state" id="uploadState">
    <div>
      <h1>Own Your Presence.</h1>
      <label for="upload" class="upload-btn">
        <span style="font-size:1.6rem;">✨</span> Upload Your Assets
      </label>
      <input id="upload" type="file" accept="image/*,video/*" multiple />
    </div>
  </div>

  <!-- DASHBOARD -->
  <div class="dashboard-state" id="dashboardState">
    <div class="container">

      <div class="header">
        <div class="profile-section">
          <img id="profileImage" class="profile-image" src="" alt="Profile" />
          <div class="profile-info">
            <h1 id="creatorName">Your Empire</h1>
            <p id="assetCount">0 assets • Ready to scale</p>
          </div>
        </div>
        <label for="addMore" class="add-more-btn">+ Add More</label>
        <input id="addMore" type="file" accept="image/*,video/*" multiple />
      </div>

      <div class="mega-stats">
        <div class="mega-card">
          <div class="mega-label">Total Earnings</div>
          <div class="mega-value" id="totalEarnings">$0</div>
          <div class="mega-sub">All-time revenue</div>
        </div>
        <div class="mega-card">
          <div class="mega-label">Avg Per Asset</div>
          <div class="mega-value" id="avgEarnings">$0</div>
          <div class="mega-sub">Performance benchmark</div>
        </div>
        <div class="mega-card">
          <div class="mega-label">Total Uses</div>
          <div class="mega-value" id="totalUses">0</div>
          <div class="mega-sub">Across portfolio</div>
        </div>
        <div class="mega-card">
          <div class="mega-label">Top Performer</div>
          <div class="mega-value" id="topPerformer">—</div>
          <div class="mega-sub">Strongest asset</div>
        </div>
      </div>

      <div class="gallery-grid" id="galleryGrid"></div>
    </div>
  </div>

<script>
// --------------------------
//   STORAGE & DATA
// --------------------------
const storage = {
  async get(key) {
    try {
      const result = await window.storage?.get(key);
      return result ? JSON.parse(result.value) : null;
    } catch {
      return null;
    }
  },
  async set(key, value) {
    try {
      await window.storage?.set(key, JSON.stringify(value));
    } catch (e) {
      console.warn('Storage save failed', e);
    }
  }
};

let assets = [];
let currentFilter = 'all';

// --------------------------
//   INIT & LISTENERS
// --------------------------
async function init() {
  const saved = await storage.get('creator-portfolio');
  if (saved?.length) {
    assets = saved;
    showDashboard();
  }
  setupListeners();
}

function setupListeners() {
  document.getElementById('upload').addEventListener('change', handleUpload);
  document.getElementById('addMore').addEventListener('change', handleUpload);
}

// --------------------------
//   MAGIC UPLOAD FLOW
// --------------------------
async function handleUpload(e) {
  const files = [...e.target.files];
  if (!files.length) return;

  // Show magic portal
  const portal = document.getElementById('magicPortal');
  const progressEl = document.getElementById('progressText');
  portal.classList.add('visible');

  let progress = 0;
  const interval = setInterval(() => {
    progress += Math.random() * 7 + 5;
    if (progress > 99) progress = 99;
    progressEl.textContent = `${Math.floor(progress)}%`;
  }, 90);

  // Process files
  for (const file of files) {
    await new Promise(resolve => {
      const reader = new FileReader();
      reader.onload = ev => {
        assets.push({
          id: Date.now() + Math.random(),
          name: file.name.replace(/\.[^/.]+$/, ""),
          type: file.type.startsWith('image/') ? 'photo' : 'video',
          preview: ev.target.result,
          earnings: Math.floor(Math.random() * 3800) + 120,
          uses: Math.floor(Math.random() * 480) + 25,
          uploadedAt: new Date().toISOString()
        });
        resolve();
      };
      reader.readAsDataURL(file);
    });
  }

  // Finish animation
  await new Promise(r => setTimeout(r, 2200 + Math.random() * 1800));
  clearInterval(interval);
  progressEl.textContent = '100%';
  await new Promise(r => setTimeout(r, 800));

  // Transition out
  portal.classList.remove('visible');
  setTimeout(() => {
    portal.classList.remove('visible'); // just in case
    showDashboard();
    storage.set('creator-portfolio', assets);
  }, 900);

  e.target.value = '';
}

// --------------------------
//   UI UPDATE FUNCTIONS
// --------------------------
function showDashboard() {
  document.getElementById('uploadState').style.display = 'none';
  document.getElementById('dashboardState').classList.add('active');

  if (assets[0]?.preview) {
    document.getElementById('profileImage').src = assets[0].preview;
  }

  updateDashboard();
}

function updateDashboard() {
  const total = assets.reduce((s, a) => s + a.earnings, 0);
  const avg = assets.length ? Math.round(total / assets.length) : 0;
  const uses = assets.reduce((s, a) => s + a.uses, 0);
  const top = assets.reduce((best, a) => a.earnings > (best?.earnings ?? 0) ? a : best, null);

  document.getElementById('assetCount').textContent = `${assets.length} assets • Ready to scale`;
  document.getElementById('totalEarnings').textContent = `$${total.toLocaleString()}`;
  document.getElementById('avgEarnings').textContent = `$${avg.toLocaleString()}`;
  document.getElementById('totalUses').textContent = uses.toLocaleString();
  document.getElementById('topPerformer').textContent = top ? `$${top.earnings.toLocaleString()}` : '—';

  renderGallery();
}

function renderGallery() {
  const grid = document.getElementById('galleryGrid');
  const filtered = currentFilter === 'all' 
    ? assets 
    : assets.filter(a => a.type === currentFilter);

  grid.innerHTML = filtered.map(asset => `
    <div class="asset-card">
      <div class="delete-icon" onclick="deleteAsset(${asset.id})">×</div>
      <div class="asset-preview">
        ${asset.type === 'photo' 
          ? `<img src="${asset.preview}" alt="${asset.name}" />`
          : `<video src="${asset.preview}" muted loop playsinline></video>`
        }
      </div>
      <div class="asset-content">
        <div class="asset-name">${asset.name}</div>
        <div class="asset-stats">
          <div class="stat-item">
            <div class="stat-label">Earnings</div>
            <div class="stat-value earnings">$${asset.earnings.toLocaleString()}</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Uses</div>
            <div class="stat-value">${asset.uses.toLocaleString()}</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Per Use</div>
            <div class="stat-value">$${(asset.earnings / asset.uses).toFixed(2)}</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Status</div>
            <div class="stat-value" style="color:#00ffaa;">Active</div>
          </div>
        </div>
      </div>
    </div>
  `).join('');
}

async function deleteAsset(id) {
  if (!confirm('Delete this asset?')) return;
  assets = assets.filter(a => a.id !== id);
  await storage.set('creator-portfolio', assets);

  if (!assets.length) {
    document.getElementById('uploadState').style.display = 'grid';
    document.getElementById('dashboardState').classList.remove('active');
  } else {
    updateDashboard();
  }
}

init();
</script>
</body>
</html>