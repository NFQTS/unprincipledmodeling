<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Creator Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    min-height: 100vh;
    font-family: 'Inter', system-ui, sans-serif;
    background: #000;
    color: #f8f9ff;
    overflow-x: hidden;
    position: relative;
  }

  /* Lightweight falling stars */
  .stars {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: -1;
  }

  .star {
    position: absolute;
    background: white;
    border-radius: 50%;
    opacity: 0;
    animation: fall linear infinite;
  }

  @keyframes fall {
    0% {
      transform: translateY(-100vh) scale(0.8);
      opacity: 0.7;
    }
    50% {
      opacity: 1;
    }
    100% {
      transform: translateY(100vh) scale(0.3);
      opacity: 0;
    }
  }

  /* Generate random stars via JS later */

  /* MAGIC PORTAL */
  .magic-portal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.98);
    backdrop-filter: blur(8px);
    z-index: 10000;
    display: grid;
    place-items: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.8s ease;
  }

  .magic-portal.visible {
    opacity: 1;
    pointer-events: all;
  }

  .portal-content {
    text-align: center;
  }

  .portal-title {
    font-size: clamp(3.8rem, 11vw, 9rem);
    font-weight: 900;
    background: linear-gradient(90deg, #ffffff, #cccccc, #ffffff);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    background-size: 200% auto;
    animation: shine 6s linear infinite;
    letter-spacing: -0.05em;
  }

  @keyframes shine {
    to { background-position: 200% center; }
  }

  .portal-subtitle {
    font-size: 1.5rem;
    color: #aaaaaa;
    margin: 1.5rem 0 4rem;
    opacity: 0.8;
  }

  .progress-text {
    font-size: 4.2rem;
    font-weight: 900;
    color: #ffffff;
    text-shadow: 0 0 40px rgba(255,255,255,0.3);
  }

  /* UPLOAD STATE */
  .upload-state {
    min-height: 100vh;
    display: grid;
    place-items: center;
    text-align: center;
    padding: 2rem;
  }

  .upload-state h1 {
    font-size: clamp(4rem, 10vw, 8rem);
    font-weight: 900;
    background: linear-gradient(90deg, #ffffff, #dddddd);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 2rem;
  }

  .upload-btn {
    display: inline-flex;
    align-items: center;
    gap: 1rem;
    background: linear-gradient(135deg, #ffffff, #cccccc);
    color: #000;
    font-weight: 900;
    font-size: 1.4rem;
    padding: 1.6rem 4rem;
    border-radius: 999px;
    border: none;
    cursor: pointer;
    box-shadow: 0 0 60px rgba(255,255,255,0.2);
    transition: all 0.4s ease;
  }

  .upload-btn:hover {
    transform: translateY(-6px);
    box-shadow: 0 0 100px rgba(255,255,255,0.35);
  }

  input[type="file"] { display: none; }

  /* DASHBOARD */
  .dashboard-state {
    display: none;
    min-height: 100vh;
    padding: 5rem 2rem 2rem;
  }

  .dashboard-state.active { display: block; }

  .container { max-width: 1480px; margin: 0 auto; }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 3rem;
    margin-bottom: 5rem;
  }

  .profile-section {
    display: flex;
    align-items: center;
    gap: 2.5rem;
  }

  .profile-image {
    width: 170px;
    height: 170px;
    border-radius: 32px;
    object-fit: cover;
    border: 3px solid rgba(255,255,255,0.15);
    box-shadow: 0 0 50px rgba(255,255,255,0.12);
  }

  .profile-info h1 {
    font-size: 3.8rem;
    font-weight: 900;
    color: white;
  }

  .profile-info p {
    color: #bbbbbb;
    font-size: 1.3rem;
    margin-top: 0.6rem;
  }

  .add-more-btn {
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.18);
    color: white;
    padding: 1.1rem 2.4rem;
    border-radius: 24px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s;
  }

  .add-more-btn:hover {
    background: rgba(255,255,255,0.15);
    transform: translateY(-3px);
  }

  /* STATS */
  .mega-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
    gap: 2.5rem;
    margin-bottom: 6rem;
  }

  .mega-card {
    background: rgba(255,255,255,0.03);
    backdrop-filter: blur(16px);
    border-radius: 32px;
    padding: 3rem 2.5rem;
    border: 1px solid rgba(255,255,255,0.08);
    transition: all 0.4s ease;
  }

  .mega-card:hover {
    transform: translateY(-12px);
    box-shadow: 0 20px 80px rgba(0,0,0,0.6);
  }

  .mega-label {
    color: #aaaaaa;
    font-size: 1rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    margin-bottom: 1.3rem;
  }

  .mega-value {
    font-size: 5.2rem;
    font-weight: 900;
    color: white;
    line-height: 1;
  }

  .mega-sub {
    color: #888888;
    margin-top: 1rem;
    font-size: 1.1rem;
  }

  /* GALLERY */
  .gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
    gap: 3rem;
  }

  .asset-card {
    background: rgba(255,255,255,0.04);
    backdrop-filter: blur(12px);
    border-radius: 32px;
    overflow: hidden;
    border: 1px solid rgba(255,255,255,0.07);
    transition: all 0.4s ease;
    position: relative;
  }

  .asset-card:hover {
    transform: translateY(-12px);
  }

  .asset-preview {
    height: 280px;
    background: #111;
  }

  .asset-preview img, .asset-preview video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .asset-content {
    padding: 2rem;
  }

  .asset-name {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1.6rem;
  }

  .asset-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.4rem;
  }

  .stat-item {
    background: rgba(255,255,255,0.03);
    border-radius: 16px;
    padding: 1.3rem;
    text-align: center;
    border: 1px solid rgba(255,255,255,0.06);
  }

  .stat-label {
    color: #aaaaaa;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    margin-bottom: 0.6rem;
  }

  .stat-value {
    font-size: 1.8rem;
    font-weight: 800;
    color: white;
  }

  .delete-icon {
    position: absolute;
    top: 1.5rem;
    left: 1.5rem;
    width: 48px;
    height: 48px;
    background: rgba(255,60,60,0.25);
    backdrop-filter: blur(10px);
    border-radius: 16px;
    color: #ff8888;
    font-size: 2rem;
    font-weight: bold;
    display: grid;
    place-items: center;
    cursor: pointer;
    transition: all 0.3s;
    z-index: 10;
  }

  .delete-icon:hover {
    background: rgba(255,60,60,0.55);
    transform: scale(1.12);
  }

  @media (max-width: 900px) {
    .header { flex-direction: column; text-align: center; }
    .profile-section { flex-direction: column; }
    .mega-stats { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

  <!-- Falling stars container -->
  <div class="stars" id="stars"></div>

  <!-- MAGIC PORTAL -->
  <div id="magicPortal" class="magic-portal">
    <div class="portal-content">
      <h1 class="portal-title">Activating profile builder...</h1>
      <p class="portal-subtitle">Creating your profile...</p>
      <div class="progress-text" id="progressText">0%</div>
    </div>
  </div>

  <!-- UPLOAD STATE -->
  <div class="upload-state" id="uploadState">
    <div>
      <h1>Become A Star</h1>
      <label for="upload" class="upload-btn">
        <span style="font-size:1.8rem;">✨</span> Upload Your Assets
      </label>
      <input id="upload" type="file" accept="image/*,video/*" multiple />
    </div>
  </div>

  <!-- DASHBOARD -->
  <div class="dashboard-state" id="dashboardState">
    <div class="container">

      <div class="header">
        <div class="profile-section">
          <img id="profileImage" class="profile-image" src="" alt="Profile" />
          <div class="profile-info">
            <h1 id="creatorName">Your Portfolio</h1>
            <p id="assetCount">0 assets • Upload 1 of each per day.</p>
          </div>
        </div>
        <label for="addMore" class="add-more-btn">+ Add More</label>
        <input id="addMore" type="file" accept="image/*,video/*" multiple />
      </div>

      <div class="mega-stats">
        <div class="mega-card">
          <div class="mega-label">Total Earnings</div>
          <div class="mega-value" id="totalEarnings">$0</div>
          <div class="mega-sub">All-time revenue</div>
        </div>
        <div class="mega-card">
          <div class="mega-label">Avg Per Asset</div>
          <div class="mega-value" id="avgEarnings">$0</div>
          <div class="mega-sub">Performance benchmark</div>
        </div>
        <div class="mega-card">
          <div class="mega-label">Total Uses</div>
          <div class="mega-value" id="totalUses">0</div>
          <div class="mega-sub">Across portfolio</div>
        </div>
        <div class="mega-card">
          <div class="mega-label">Top Performer</div>
          <div class="mega-value" id="topPerformer">—</div>
          <div class="mega-sub">Strongest signal</div>
        </div>
      </div>

      <div class="gallery-grid" id="galleryGrid"></div>
    </div>
  </div>

<script>
// Falling stars (lightweight)
function createStars() {
  const starsContainer = document.getElementById('stars');
  for (let i = 0; i < 60; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    const size = Math.random() * 3 + 1;
    star.style.width = star.style.height = `${size}px`;
    star.style.left = `${Math.random() * 100}vw`;
    star.style.animationDuration = `${Math.random() * 12 + 8}s`;
    star.style.animationDelay = `${Math.random() * 10}s`;
    starsContainer.appendChild(star);
  }
}
createStars();

// Storage & Data
const storage = {
  async get(key) {
    try {
      const result = await window.storage?.get(key);
      return result ? JSON.parse(result.value) : null;
    } catch {
      return null;
    }
  },
  async set(key, value) {
    try {
      await window.storage?.set(key, JSON.stringify(value));
    } catch (e) {}
  }
};

let assets = [];

// Init & Listeners
async function init() {
  const saved = await storage.get('creator-portfolio');
  if (saved?.length) {
    assets = saved;
    showDashboard();
  }
  document.getElementById('upload').addEventListener('change', handleUpload);
  document.getElementById('addMore').addEventListener('change', handleUpload);
}

// Magic Upload Flow
async function handleUpload(e) {
  const files = [...e.target.files];
  if (!files.length) return;

  const portal = document.getElementById('magicPortal');
  const progressEl = document.getElementById('progressText');
  portal.classList.add('visible');

  let progress = 0;
  const interval = setInterval(() => {
    progress += Math.random() * 6 + 4;
    if (progress > 99) progress = 99;
    progressEl.textContent = `${Math.floor(progress)}%`;
  }, 100);

  for (const file of files) {
    await new Promise(resolve => {
      const reader = new FileReader();
      reader.onload = ev => {
        assets.push({
          id: Date.now() + Math.random(),
          name: file.name.replace(/\.[^/.]+$/, ""),
          type: file.type.startsWith('image/') ? 'photo' : 'video',
          preview: ev.target.result,
          earnings: 0,
          uses: 0,
          uploadedAt: new Date().toISOString()
        });
        resolve();
      };
      reader.readAsDataURL(file);
    });
  }

  await new Promise(r => setTimeout(r, 2400 + Math.random() * 1600));
  clearInterval(interval);
  progressEl.textContent = '100%';
  await new Promise(r => setTimeout(r, 900));

  portal.classList.remove('visible');
  setTimeout(() => {
    showDashboard();
    storage.set('creator-portfolio', assets);
  }, 1000);

  e.target.value = '';
}

function showDashboard() {
  document.getElementById('uploadState').style.display = 'none';
  document.getElementById('dashboardState').classList.add('active');

  if (assets[0]?.preview) {
    document.getElementById('profileImage').src = assets[0].preview;
  }

  updateDashboard();
}

function updateDashboard() {
  const total = assets.reduce((s, a) => s + a.earnings, 0);
  const avg = assets.length ? Math.round(total / assets.length) : 0;
  const uses = assets.reduce((s, a) => s + a.uses, 0);
  const top = assets.reduce((best, a) => a.earnings > (best?.earnings ?? 0) ? a : best, null);

  document.getElementById('assetCount').textContent = `${assets.length} asset${assets.length !== 1 ? 's' : ''} • The void awaits`;
  document.getElementById('totalEarnings').textContent = `$${total.toLocaleString()}`;
  document.getElementById('avgEarnings').textContent = `$${avg.toLocaleString()}`;
  document.getElementById('totalUses').textContent = uses.toLocaleString();
  document.getElementById('topPerformer').textContent = top ? `$${top.earnings.toLocaleString()}` : '—';

  renderGallery();
}

function renderGallery() {
  const grid = document.getElementById('galleryGrid');
  grid.innerHTML = assets.map(asset => `
    <div class="asset-card">
      <div class="delete-icon" onclick="deleteAsset(${asset.id})">×</div>
      <div class="asset-preview">
        ${asset.type === 'photo' 
          ? `<img src="${asset.preview}" alt="${asset.name}" />`
          : `<video src="${asset.preview}" muted loop playsinline></video>`
        }
      </div>
      <div class="asset-content">
        <div class="asset-name">${asset.name}</div>
        <div class="asset-stats">
          <div class="stat-item">
            <div class="stat-label">Earnings</div>
            <div class="stat-value">$${asset.earnings.toLocaleString()}</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Uses</div>
            <div class="stat-value">${asset.uses.toLocaleString()}</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Per Use</div>
            <div class="stat-value">$${asset.uses ? (asset.earnings / asset.uses).toFixed(2) : '0.00'}</div>
          </div>
          <div class="stat-item">
            <div class="stat-label">Status</div>
            <div class="stat-value" style="color:#88ffaa;">Active</div>
          </div>
        </div>
      </div>
    </div>
  `).join('');
}

async function deleteAsset(id) {
  if (!confirm('Delete this asset?')) return;
  assets = assets.filter(a => a.id !== id);
  await storage.set('creator-portfolio', assets);

  if (!assets.length) {
    document.getElementById('uploadState').style.display = 'grid';
    document.getElementById('dashboardState').classList.remove('active');
  } else {
    updateDashboard();
  }
}

init();
</script>
</body>
</html>